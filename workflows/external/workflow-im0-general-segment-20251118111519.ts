import { test, expect } from '@playwright/test';

test.use({
  ignoreHTTPSErrors: true
});

test('test', async ({ page }) => {
  await page.locator('#demoCLR').click();
  await page.getByRole('link', { name: 'Declaration' }).click();
  await page.getByRole('link', { name: 'Capture' }).click();
  await page.locator('iframe').nth(1).contentFrame().locator('#sclist1087 > .ui_list_ListOfValue_button').click();
  await page.locator('iframe').nth(1).contentFrame().getByText('Import Declaration Form').click();
  await page.locator('iframe').nth(1).contentFrame().getByRole('textbox').nth(2).click();
  await page.locator('iframe').nth(1).contentFrame().getByText('WIL', { exact: true }).click();
  await page.locator('iframe').nth(1).contentFrame().locator('#sclist1090 > .ui_list_ListOfValue_button').click();
  await page.locator('iframe').nth(1).contentFrame().getByText('WILSON AIRPORT').click();
  await page.locator('iframe').nth(1).contentFrame().locator('#Con7754').click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b14_declarant_tr"]').click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b14_declarant_tr"]').dblclick();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b14_declarant_tr"]').press('ControlOrMeta+c');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b8_consignee_tr"]').click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b8_consignee_tr"]').fill('P000600883U');
  await page.locator('iframe').nth(1).contentFrame().getByRole('cell', { name: '2. Consignor / exporter - Registered - Registration Number - Name - Address - Nationality Email Country code 16. Date of Exit/Arrival 23. Exchange rate D.Seals Number Seal Activation D. CD acceptance date and time D. CD acceptance officer Transfer funds flag Transfer funds CD registration number Rotation Number Rotation validation date/time', exact: true }).click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_registered"]').check();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').press('CapsLock');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').fill('A');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').press('CapsLock');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').fill('Anne ');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').press('CapsLock');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').fill('Anne W');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').press('CapsLock');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').fill('Anne Welbert');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_country"]').click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_country"]').press('CapsLock');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_country"]').fill('US');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_country"]').press('CapsLock');
  await page.locator('#win-tabs').getByRole('link', { name: 'X' }).click();
  await page.getByRole('link', { name: 'Capture' }).click();
  await page.locator('iframe').nth(1).contentFrame().locator('#sclist1087 > .ui_list_ListOfValue_button').click();
  await page.locator('iframe').nth(1).contentFrame().getByText('Import Declaration Form').click();
  await page.locator('iframe').nth(1).contentFrame().locator('.ui_list_ListOfValue_button').first().click();
  await page.locator('iframe').nth(1).contentFrame().getByText('WILSON APT/NAIROBI').click();
  await page.locator('iframe').nth(1).contentFrame().locator('#sclist1090 > .ui_list_ListOfValue_button').click();
  await page.locator('iframe').nth(1).contentFrame().getByText('WILSON AIRPORT').click();
  await page.locator('iframe').nth(1).contentFrame().locator('#Con7754').click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b14_declarant_tr"]').dblclick();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b14_declarant_tr"]').click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b14_declarant_tr"]').dblclick();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b14_declarant_tr"]').press('ControlOrMeta+c');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b8_consignee_tr"]').click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b8_consignee_tr"]').fill('P000600883U');
  await page.locator('iframe').nth(1).contentFrame().locator('#Con7754').click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_registered"]').check();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_registered"]').uncheck();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').press('CapsLock');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').fill('M');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').press('CapsLock');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').fill('Mark ');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').press('CapsLock');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').fill('Mark P');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').press('CapsLock');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_name"]').fill('Mark Peter');
  await page.locator('iframe').nth(1).contentFrame().locator('textarea[name="b2_address"]').click();
  await page.locator('iframe').nth(1).contentFrame().locator('textarea[name="b2_address"]').fill('8755\n');
  await page.locator('iframe').nth(1).contentFrame().locator('textarea[name="b2_address"]').press('CapsLock');
  await page.locator('iframe').nth(1).contentFrame().locator('textarea[name="b2_address"]').fill('8755\nUSA');
  await page.locator('iframe').nth(1).contentFrame().locator('textarea[name="b2_address"]').press('CapsLock');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_country"]').click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_country"]').press('CapsLock');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_country"]').fill('US');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b2_country"]').press('CapsLock');
  await page.locator('iframe').nth(1).contentFrame().locator('#sclist1099 > .ui_list_ListOfValue_button').click();
  await page.locator('iframe').nth(1).contentFrame().getByText('Cost, insurance and freigh..').click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b20_deliv_terms_sub2"]').click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b20_deliv_terms_sub2"]').press('CapsLock');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b20_deliv_terms_sub2"]').fill('WAP');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b20_deliv_terms_sub2"]').press('CapsLock');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b22_total_amount"]').click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b22_total_amount"]').fill('7000');
  await page.locator('iframe').nth(1).contentFrame().getByText('Movements').first().click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="b25_border_trans"]').click();
  await page.locator('iframe').nth(1).contentFrame().getByText('Air transport').click();
  await page.locator('iframe').nth(1).contentFrame().getByText('Attachments').first().click();
  await page.locator('iframe').nth(1).contentFrame().getByRole('link').click();
  await page.locator('iframe').nth(1).contentFrame().getByRole('cell').filter({ hasText: /^$/ }).nth(1).click();
  await page.locator('iframe').nth(1).contentFrame().getByRole('cell').filter({ hasText: /^$/ }).nth(1).click();
  await page.locator('iframe').nth(1).contentFrame().locator('#List9023 > .ui_list_ListOfValue_button').click();
  await page.locator('iframe').nth(1).contentFrame().getByText('General', { exact: true }).click();
  await page.locator('iframe').nth(1).contentFrame().locator('#List9024 > .ui_list_ListOfValue_button').click();
  await page.locator('iframe').nth(1).contentFrame().getByText('Proforma Invoice').click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="serial_num"]').click();
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="serial_num"]').press('CapsLock');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="serial_num"]').fill('INV003');
  await page.locator('iframe').nth(1).contentFrame().locator('input[name="serial_num"]').press('CapsLock');
  await page.locator('iframe').nth(1).contentFrame().getByRole('button', { name: 'Save' }).click();
});